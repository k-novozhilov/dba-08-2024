# Домашняя работа №10 "Типы данных в MySQL"

## 1. Анализ и изменение типов данных

### Текущие типы данных
На основе предоставленной структуры базы данных, можно выделить следующие типы данных:
- `varchar(255)`: Используется для строковых данных, таких как имена, email и т.д.
- `timestamp(0)`: Используется для хранения даты и времени.
- `bigint`: Используется для уникальных идентификаторов.
- `integer`: Используется для числовых данных, таких как количество, идентификаторы внещних систем и т.д.
- `boolean`: Используется для логических значений.

### Изменения типов данных
1. **Поле `email` в таблице `employees`**:
   - Текущий тип: `varchar(255)`
   - Новый тип: `varchar(200)`
     **Причина**: В некоторых системах длина индекса ограничена, и уменьшение длины поля может помочь в оптимизации.

2. **Поле `division` в таблице `employees`**:
   - Текущий тип: `varchar(255)`
   - Новый тип: `varchar(100)`
     **Причина**: Длина названия подразделения не превышает 100 символов, что позволяет сэкономить место.

3. **Поле `created_at` и `updated_at` в таблице `employees`**:
   - Текущий тип: `timestamp(0)`
   - Новый тип: `timestamp`
     **Причина**: Убрана точность до секунд для упрощения и унификации.

## 2. Добавление типа JSON

### Анализ данных для хранения в JSON
Тип JSON может быть полезен для хранения данных, которые имеют переменную структуру или могут изменяться со временем. Например:

- Дополнительные атрибуты сотрудника, такие как навыки, предпочтения, настройки.
- История изменений данных сотрудника.
- Конфигурации или параметры, которые могут варьироваться.

Будем добавлять тип JSONB, т.к. он хранит данные в двоичном формате, что позволяет быстрее индексировать и выполнять запросы по сравнению с обычным типом JSON. 

### Добавление JSONB поля в таблицу employees

```postgresql
ALTER TABLE employees ADD COLUMN additional_info JSONB;
```

### Добавление записи с JSON данными
```postgresql
INSERT INTO employees (name, surname, email, division, additional_info)
VALUES ('Иван', 'Иванов', 'iivanov@example.com', 'IT', '{"skills": ["Java", "Python"], "preferences": {"notifications": true}}');
```

### Выборка данных из JSONB поля

```postgresql
SELECT name, surname, additional_info->'skills' AS skills
FROM employees
WHERE additional_info->'preferences'->>'notifications' = 'true';
```
### Обновление JSONB данных
```postgresql
UPDATE employees
SET additional_info = jsonb_set(additional_info, '{preferences,notifications}', 'false')
WHERE email = 'john.doe@example.com';
```